<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="homeQna.mapper">

	<!-- 공지사항 신규 글 등록 -->
	<insert id="homeInsert">
		insert into web_qna (qna_id, customer_email, qna_title, qna_content, qna_filename, qna_filepath,
			qna_attribute)
		values ( seq_web_qna.nextval, #{customer_email}, #{qna_title}, #{qna_content}
			, #{qna_filename, jdbcType=VARCHAR }, #{qna_filepath, jdbcType=VARCHAR }, #{qna_attribute})
	</insert>
	
	
	<!-- 글 목록 조회 -->	
	<select id="homeQnaList" resultType="homeQna.QnaVO">
		select w.*,  c.customer_name customer_name
		from web_qna w, customer c
		where w.customer_email = c.customer_email
		order by w.qna_id desc
	</select>
	
		<sql id = 'where_search'>
		<if test="search == 'notice' ">
			where NOTICE_ATTRIBUTE = 'N' 
			<if test="keyword != null">
   				and notice_title like '%'||#{keyword}||'%'
   		</if>
		</if>
		<if test="search == 'alphacer' ">
			where NOTICE_ATTRIBUTE = 'A' 
			<if test="keyword != null">
   				and notice_title like '%'||#{keyword}||'%'
   			</if>
		</if>
	
		<if test="search == 'maintainance' ">
			where NOTICE_ATTRIBUTE = 'M' 
			<if test="keyword != null">
   				and notice_title like '%'||#{keyword}||'%'
   			</if>
		</if>
		<if test="search == 'all' ">
			
   			<if test="keyword != null">
   				where notice_title like '%'||#{keyword}||'%'
   			</if>
		</if>
	</sql>
		
	
	<!-- 전체 공지글 수 조회 -->
	
	<select id="hometotalList" resultType="integer">
		select count(*) from web_qna <include refid="where_search" />
	</select>
</mapper>